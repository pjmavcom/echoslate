<UserControl x:Class="Echoslate.Wpf.Views.ItemNotesPanelView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:b="http://schemas.microsoft.com/xaml/behaviors" xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:Echoslate.Wpf.Views" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d">

    <Grid Margin="10" DataContext="{Binding SelectedTodoItem, RelativeSource={RelativeSource AncestorType=UserControl}}">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="65" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="3*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="3*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="3*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="5*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Label Grid.Row="0" Content="Title:" />
        <Border Grid.Row="1"
                Margin="8,4"
                Background="#1E1E1E" CornerRadius="7">
            <Grid>
                <Border BorderBrush="#999999" BorderThickness="7,7,0,0"
                        CornerRadius="7" />
                <Border Margin="-1"
                        BorderBrush="#494949" BorderThickness="0,0,7,7"
                        CornerRadius="7" IsHitTestVisible="False" />
                <TextBox x:Name="tbTodo"
                         Margin="1"
                         AcceptsReturn="False"
                         Text="{Binding Todo, UpdateSourceTrigger=LostFocus, Mode=TwoWay}"
                         TextWrapping="WrapWithOverflow">
                    <TextBox.InputBindings>
                        <KeyBinding Key="Enter"
                                    Command="{Binding CommitTitleEditCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                    CommandParameter="{Binding}" />
                    </TextBox.InputBindings>
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="PropertyChanged">
                            <b:InvokeCommandAction Command="{Binding DataContext.RefreshAllCommand, RelativeSource={RelativeSource AncestorType={x:Type local:TodoDisplayView}}}" />
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                </TextBox>
            </Grid>
        </Border>
        <Label Grid.Row="2" Content="Notes:" />
        <Border Grid.Row="3"
                Margin="8,4"
                Background="#1E1E1E" CornerRadius="7">
            <Grid>
                <Border BorderBrush="#999999" BorderThickness="7,7,0,0"
                        CornerRadius="7" />
                <Border Margin="-1"
                        BorderBrush="#494949" BorderThickness="0,0,7,7"
                        CornerRadius="7" IsHitTestVisible="False" />
                <TextBox Margin="1"
                         AcceptsReturn="True" ScrollViewer.VerticalScrollBarVisibility="Auto"
                         Text="{Binding Notes, UpdateSourceTrigger=PropertyChanged}"
                         TextWrapping="WrapWithOverflow">
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="PropertyChanged">
                            <b:InvokeCommandAction Command="{Binding DataContext.RefreshAllCommand, RelativeSource={RelativeSource AncestorType={x:Type local:TodoDisplayView}}}" />
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                </TextBox>
            </Grid>
        </Border>
        <Label Grid.Row="4" Content="Problem:" />
        <Border Grid.Row="5" Grid.Column="0"
                Margin="8,4"
                Background="#1E1E1E" CornerRadius="7">
            <Grid>
                <Border BorderBrush="#999999" BorderThickness="7,7,0,0"
                        CornerRadius="7" />
                <Border Margin="-1"
                        BorderBrush="#494949" BorderThickness="0,0,7,7"
                        CornerRadius="7" IsHitTestVisible="False" />
                <TextBox Margin="1"
                         AcceptsReturn="True" ScrollViewer.VerticalScrollBarVisibility="Auto"
                         Text="{Binding Problem, UpdateSourceTrigger=PropertyChanged}"
                         TextWrapping="WrapWithOverflow">
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="PropertyChanged">
                            <b:InvokeCommandAction Command="{Binding DataContext.RefreshAllCommand, RelativeSource={RelativeSource AncestorType={x:Type local:TodoDisplayView}}}" />
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                </TextBox>
            </Grid>
        </Border>
        <Label Grid.Row="6" Content="Solution:" />
        <Border Grid.Row="7"
                Margin="8,4"
                Background="#1E1E1E" CornerRadius="7">
            <Grid>
                <Border BorderBrush="#999999" BorderThickness="7,7,0,0"
                        CornerRadius="7" />
                <Border Margin="-1"
                        BorderBrush="#494949" BorderThickness="0,0,7,7"
                        CornerRadius="7" IsHitTestVisible="False" />
                <TextBox Margin="1"
                         AcceptsReturn="True" ScrollViewer.VerticalScrollBarVisibility="Auto"
                         Text="{Binding Solution, UpdateSourceTrigger=PropertyChanged}"
                         TextWrapping="WrapWithOverflow">
                    <b:Interaction.Triggers>
                        <b:EventTrigger EventName="PropertyChanged">
                            <b:InvokeCommandAction Command="{Binding DataContext.RefreshAllCommand, RelativeSource={RelativeSource AncestorType={x:Type local:TodoDisplayView}}}" />
                        </b:EventTrigger>
                    </b:Interaction.Triggers>
                </TextBox>
            </Grid>
        </Border>
        <StackPanel Grid.Row="8" Orientation="Horizontal">
            <Label Margin="2" HorizontalAlignment="Right"
                   Content="Tags:" />
            <Button Width="72" Height="35"
                    Command="{Binding NotesPanelAddTagCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                    Content="Edit Tags"
                    IsEnabled="{Binding IsEnabled, RelativeSource={RelativeSource AncestorType=UserControl}}" />
        </StackPanel>
        <ListBox Grid.Row="9"
                 Margin="3"
                 IsSynchronizedWithCurrentItem="True"
                 ItemsSource="{Binding Tags}" />
        <Button Grid.Row="10"
                Width="100"
                Command="{Binding NotesPanelCompleteCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                Content="Complete"
                IsEnabled="{Binding IsEnabled, RelativeSource={RelativeSource AncestorType=UserControl}}" />
    </Grid>
</UserControl>
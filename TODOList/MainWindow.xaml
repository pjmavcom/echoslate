<Window x:Class="TODOList.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		xmlns:wpfTool="clr-namespace:Xceed.Wpf.Toolkit;assembly=Xceed.Wpf.Toolkit"
        xmlns:local="clr-namespace:TODOList"
		mc:Ignorable="d"
        Title="{Binding WindowTitle}" Height="1080" Width="1920"
		FocusManager.FocusedElement="{Binding ElementName=lbIncompleteItems}" 
		Style="{StaticResource {x:Type Window}}" >

	<Window.Resources >
		<local:ProgressBarForegroundConverter x:Key="pbfg" />

		<RoutedUICommand x:Key="Add" Text="Text" />
		<RoutedUICommand x:Key="Complete" Text="Some Text" />
		<RoutedUICommand x:Key="Edit" Text="Another Text" />
		<RoutedUICommand x:Key="SwitchTab" Text="Yet Another Text" />
		<RoutedUICommand x:Key="SwitchSeverity" Text="And Yet Another Text" />
		<RoutedUICommand x:Key="QuickSave" Text="And Yet Another Text" />
		<RoutedUICommand x:Key="QuickLoadPrevious" Text="And Yet Another Another Text" />
		<RoutedUICommand x:Key="StartStopTimer" Text="And Yet Another Another Text" />
	</Window.Resources >

	<Window.CommandBindings>
		<CommandBinding Command="{StaticResource Add}" Executed="hkAdd" />
		<CommandBinding Command="{StaticResource Complete}" Executed="hkComplete" />
		<CommandBinding Command="{StaticResource Edit}" Executed="hkEdit" />
		<CommandBinding Command="{StaticResource SwitchTab}" Executed="hkSwitchTab" />
		<CommandBinding Command="{StaticResource SwitchSeverity}" Executed="hkSwitchSeverity" />
		<CommandBinding Command="{StaticResource QuickSave}" Executed="hkQuickSave" />
		<CommandBinding Command="{StaticResource QuickLoadPrevious}" Executed="hkQuickLoadPrevious" />
		<CommandBinding Command="{StaticResource StartStopTimer}" Executed="hkStartStopTimer" />
	</Window.CommandBindings>

	<Window.InputBindings>
		<KeyBinding Key="Enter" Modifiers="Alt" Command="{StaticResource Add}" />
		<KeyBinding Key="Enter" Modifiers="Control" Command="{StaticResource Complete}" />
		<KeyBinding Key="Enter" Command="{StaticResource Edit}" />
		<KeyBinding Key="Divide" Command="{StaticResource SwitchTab}" CommandParameter="left" />
		<KeyBinding Key="Multiply" Command="{StaticResource SwitchTab}" CommandParameter="right" />
		<KeyBinding Key="Subtract" Command="{StaticResource SwitchSeverity}" CommandParameter="up" />
		<KeyBinding Key="Add" Command="{StaticResource SwitchSeverity}" CommandParameter="down" />
		<KeyBinding Key="S" Modifiers="Control" Command="{StaticResource QuickSave}" />
		<KeyBinding Key="OemComma" Modifiers="Control" Command="{StaticResource QuickLoadPrevious}" />
		<KeyBinding Key="P" Modifiers="Control" Command="{StaticResource StartStopTimer}" />
	</Window.InputBindings>


	<DockPanel TextElement.FontSize="16" TextElement.FontFamily="Source Code Pro">
		<Grid DockPanel.Dock="Top" >
			<Grid.ColumnDefinitions >
				<ColumnDefinition Width="500" />
				<ColumnDefinition />
			</Grid.ColumnDefinitions >
			<Menu Name="mnuMain" FontSize="16" Grid.Column="0" >
				<MenuItem Header="_File" >
					<MenuItem Header="New" Click="mnuNew_OnClick" />
					<Separator />
					<MenuItem Header="Load" Click="mnuLoad_OnClick" />
					<Separator />
					<MenuItem Header="Save" Click="mnuSave_OnClick" />
					<MenuItem Header="SaveAs" Click="mnuSaveAs_OnClick" />
					<Separator />
					<MenuItem Header="Options" Click="mnuOptions_OnClick" />
					<Separator />
					<MenuItem Header="Quit" Click="mnuQuit_OnClick" />
				</MenuItem >
				<MenuItem Name="mnuRecentLoads" Header="Recent Loads" ItemsSource="{Binding RecentFiles}" Click="mnuLoadFiles_OnClick" MouseRightButtonUp="mnuRecentLoads_OnRMBUp" >
					<MenuItem.ContextMenu>
						<ContextMenu >
							<MenuItem Header="Remove" Click="mnuRemoveFile_OnClick" CommandParameter="{Binding RelativeSource={RelativeSource Self}, Path=Parent}" DataContext="{Binding PlacementTarget.DataContext, RelativeSource={RelativeSource Self}}"/>
						</ContextMenu >
					</MenuItem.ContextMenu>
				</MenuItem >
				<MenuItem Header="Help" Click="mnuHelp_OnClick" />
			</Menu >
			<StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Grid.Column="1" >
				<Grid >
					<ProgressBar Name="pbPomo" Value="{Binding PomoTimeLeft, UpdateSourceTrigger=PropertyChanged}" Minimum="0" Maximum="100" BorderBrush="DarkSlateGray" Background="Maroon" Height="30" Width="400" />
					<Label Name="lblPomo" Width="400" MouseUp="PomoTimerToggle_OnClick" MouseDoubleClick="PomoTimerReset_OnClick" HorizontalContentAlignment="Right" Foreground="Black" FontWeight="SemiBold" FontSize="20" />
				</Grid >
				<Label Content="Work: " Width="100" />
				<wpfTool:IntegerUpDown Name="iudPomoWork" Minimum="1" Value="{Binding PomoWorkTime, UpdateSourceTrigger=PropertyChanged}" ValueChanged="PomoWork_OnValueChanged" Width="80" />
				<Label Content="Break: " Width="100" />
				<wpfTool:IntegerUpDown Name="iudPomoBreak" Minimum="1" Value="{Binding PomoBreakTime, UpdateSourceTrigger=PropertyChanged}" ValueChanged="PomoBreak_OnValueChanged" Width="80" />
			</StackPanel >
		</Grid >

		<TabControl Name="TabControl" >
			<!-- VCS History tab -->
			<TabItem Name="tabHistory" Header="History" KeyboardNavigation.IsTabStop="False" >
				<Grid >
					<Grid.ColumnDefinitions >
						<ColumnDefinition Width="300" />
						<ColumnDefinition />
					</Grid.ColumnDefinitions >
					<Grid Grid.Column="0" >
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="97*"/>
							<ColumnDefinition Width="203*"/>
						</Grid.ColumnDefinitions>
						<Grid.RowDefinitions >
							<RowDefinition Height="35" />
							<RowDefinition />
						</Grid.RowDefinitions >
						<StackPanel Grid.Row="0" Orientation="Horizontal" Grid.ColumnSpan="2" >
							<Button Content="New" Click="NewHistory_OnClick" Width="90" KeyboardNavigation.IsTabStop="False" />
							<Button Content="Delete" Click="DeleteHistory_OnClick" Width="90" KeyboardNavigation.IsTabStop="False" />
						</StackPanel >
						<ListBox Grid.Row="1" Name="lbHistory" ItemsSource="{Binding HistoryItems}" KeyDown="HistoryListBox_OnKeyDown" PreviewMouseLeftButtonDown="HistoryListBox_OnMouseDown" SelectionChanged="HistoryListBox_OnSelectionChange" ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.VerticalScrollBarVisibility="Auto" Grid.ColumnSpan="2" >
							<ListBox.ContextMenu >
								<ContextMenu >
									<MenuItem Header="Reset Copied" Click="mnuResetHistoryCopied_OnClick" />
								</ContextMenu >
							</ListBox.ContextMenu >
							<ListBox.ItemTemplate >
								<DataTemplate >
									<Grid Margin="0,2" >
										<Grid.ColumnDefinitions >
											<ColumnDefinition Width="25" />
											<ColumnDefinition />
										</Grid.ColumnDefinitions >
										<Button Grid.Column="0" FontFamily="Marlett" FontSize="20" Content="1" Click="CopyHistory_OnClick" KeyboardNavigation.IsTabStop="False" >
											<Button.Style >
												<Style >
													<Style.Triggers >
														<DataTrigger Binding="{Binding HasBeenCopied}" Value="True" >
															<Setter Property="Label.Background" Value="ForestGreen" />
															<Setter Property="Label.Foreground" Value="Black" />
														</DataTrigger >
														<DataTrigger Binding="{Binding HasBeenCopied}" Value="False" >
															<Setter Property="Label.Background" Value="#222" />
															<Setter Property="Label.Foreground" Value="Black" />
														</DataTrigger >
													</Style.Triggers >
												</Style >
											</Button.Style >
										</Button >
										<TextBlock Grid.Column="1" Text="{Binding Title}" TextWrapping="Wrap" />
									</Grid >
								</DataTemplate >
							</ListBox.ItemTemplate >
						</ListBox >
					</Grid >

					<Grid Grid.Column="1" >
						<Grid.RowDefinitions >
							<RowDefinition Height="35" />
							<RowDefinition Height="35" />
							<RowDefinition />
							<RowDefinition />
							<RowDefinition />
							<RowDefinition />
						</Grid.RowDefinitions >
						<StackPanel Orientation="Horizontal" Grid.Row="0">
							<Label Content="Time: " Margin="2" />
							<Label Name="lblHTotalTime" Margin="2" Width="40" />
						</StackPanel >
						<TextBox Grid.Row="1" Name="tbHTitle" TextWrapping="NoWrap" TextChanged="Title_OnTextChange" ScrollViewer.VerticalScrollBarVisibility="Disabled" />
						<TextBox Grid.Row="2" Name="tbHNotes" AcceptsReturn="True" TextWrapping="Wrap" TextChanged="Notes_OnTextChange" ScrollViewer.VerticalScrollBarVisibility="Auto" />
						<ListBox Grid.Row="3" Name="lbCompletedTodosBugs" HorizontalContentAlignment="Stretch" ScrollViewer.HorizontalScrollBarVisibility="Disabled" MouseDoubleClick="mnuEditHistoryTodo_OnClick" >
							<ListBox.ItemTemplate >
								<DataTemplate >
									<Grid ToolTip="{Binding NotesAndTags}" Margin="0,2" >
										<Grid.ColumnDefinitions >
											<ColumnDefinition Width="25" />
											<ColumnDefinition />
										</Grid.ColumnDefinitions >
										<Button Grid.Column="0" Name="btnHDeleteTodo" FontFamily="Marlett" FontSize="20" Content="r" Click="DeleteTodo_OnClick" KeyboardNavigation.IsTabStop="False" />
										<TextBlock Grid.Column="1" Text="{Binding Todo}" TextAlignment="Left" TextWrapping="Wrap" Margin="4" />
									</Grid >
								</DataTemplate >
							</ListBox.ItemTemplate >
						</ListBox >
						<ListBox Grid.Row="4" Name="lbCompletedTodosFeatures" HorizontalContentAlignment="Stretch" ScrollViewer.HorizontalScrollBarVisibility="Disabled" MouseDoubleClick="mnuEditHistoryTodo_OnClick" >
							<ListBox.ItemTemplate >
								<DataTemplate >
									<Grid ToolTip="{Binding NotesAndTags}" Margin="0,2" >
										<Grid.ColumnDefinitions >
											<ColumnDefinition Width="25" />
											<ColumnDefinition />
										</Grid.ColumnDefinitions >
										<Button Grid.Column="0" Name="btnHDeleteTodo" FontFamily="Marlett" FontSize="20" Content="r" Click="DeleteTodo_OnClick" KeyboardNavigation.IsTabStop="False" />
										<TextBlock Grid.Column="1" Text="{Binding Todo}" TextAlignment="Left" TextWrapping="Wrap" Margin="4" />
									</Grid >
								</DataTemplate >
							</ListBox.ItemTemplate >
						</ListBox >
						<ListBox Grid.Row="5" Name="lbCompletedTodos" HorizontalContentAlignment="Stretch" ScrollViewer.HorizontalScrollBarVisibility="Disabled" MouseDoubleClick="mnuEditHistoryTodo_OnClick" >
							<ListBox.ItemTemplate >
								<DataTemplate >
									<Grid ToolTip="{Binding NotesAndTags}" Margin="0,2" >
										<Grid.ColumnDefinitions >
											<ColumnDefinition Width="25" />
											<ColumnDefinition />
										</Grid.ColumnDefinitions >
										<Button Grid.Column="0" Name="btnHDeleteTodo" FontFamily="Marlett" FontSize="20" Content="r" Click="DeleteTodo_OnClick" KeyboardNavigation.IsTabStop="False" />
										<TextBlock Grid.Column="1" Text="{Binding Todo}" TextAlignment="Left" TextWrapping="Wrap" Margin="4" />
									</Grid >
								</DataTemplate >
							</ListBox.ItemTemplate >
						</ListBox >
					</Grid >
				</Grid >
			</TabItem >

			<TabItem Name="tabTodos" Header="TODOs" HorizontalAlignment="Right" Width="64" Height="26" VerticalAlignment="Center" >
				<Grid >
					<Grid.ColumnDefinitions>
						<ColumnDefinition />
						<ColumnDefinition Width="500"/>
					</Grid.ColumnDefinitions>
					<Grid.RowDefinitions >
						<RowDefinition />
						<RowDefinition Height="100" />
					</Grid.RowDefinitions >
					<Grid Grid.Row="0" Grid.Column="0">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="7*"/>
							<ColumnDefinition Width="228*"/>
						</Grid.ColumnDefinitions>

						<TabControl Name="_todoTabs" ItemsSource="{Binding}" SelectionChanged="tabSelectionChanged" Grid.ColumnSpan="2" >
							<TabControl.ContextMenu >
								<ContextMenu >
									<MenuItem Header="Edit Tabs" Click="mnuEditTabs_OnClick" />
								</ContextMenu >
							</TabControl.ContextMenu >
							<TabControl.ContentTemplate >
								<DataTemplate >
									<Grid  >
										<Grid.RowDefinitions >
											<RowDefinition Height="30" />
											<RowDefinition Height="*" />
											<!-- <RowDefinition Height="100" /> -->
										</Grid.RowDefinitions >

										<Grid >
											<Grid.ColumnDefinitions >
												<ColumnDefinition Width="10" />

												<ColumnDefinition Width="200" />
												<ColumnDefinition Width="160" />
												<ColumnDefinition Width="100" />

												<ColumnDefinition Width="90" />
												<ColumnDefinition Width="150" />
												<ColumnDefinition />

											</Grid.ColumnDefinitions >
											<ComboBox Grid.Column="1" Name="cbHashTags" ItemsSource="{Binding HashTags}" SelectionChanged="Hashtags_OnSelectionChange" KeyboardNavigation.IsTabStop="False" />
											<Button Grid.Column="2" Name="btnSortDate" Content="Date" Click="Sort_OnClick" CommandParameter="date" KeyboardNavigation.IsTabStop="False" />
											<Button Grid.Column="3" Name="btnSortSeverity" Content="Severity" Click="Sort_OnClick" CommandParameter="sev" KeyboardNavigation.IsTabStop="False" />

											<Button Grid.Column="4" Name="btnSortRank" Content="Rank" Click="Sort_OnClick" CommandParameter="rank" KeyboardNavigation.IsTabStop="False" />
											<Button Grid.Column="5" Name="btnSortActive" Content="Active" Click="Sort_OnClick" CommandParameter="active" KeyboardNavigation.IsTabStop="False" />

										</Grid >

										<!-- The list of incomplete todos -->
										<ListBox Name="lbIncompleteItems" ItemsSource="{Binding IncompleteItems}" HorizontalContentAlignment="Stretch" Grid.Row="1" KeyboardNavigation.TabIndex="0" ScrollViewer.HorizontalScrollBarVisibility="Disabled" MouseDoubleClick="mnuEditTodo_OnClick" SelectionChanged="IncompleteItems_OnSelectionChange" SelectionMode="Extended" >
											<ListBox.ContextMenu >
												<ContextMenu >
													<MenuItem Name="cmnuEdit" Header="Edit" Click="mnuEditTodo_OnClick" />
													<MenuItem Name="cmnuDelete" Header="Delete" Click="mnuDelete_OnClick" />
													<Separator />
													<MenuItem Name="cmnuResetTimer" Header="Reset Timer" Click="mnuResetTimer_OnClick" />
												</ContextMenu >
											</ListBox.ContextMenu >
											<ListBox.ItemTemplate >
												<DataTemplate >
													<Grid ToolTip="{Binding NotesAndTags}" Margin="0,2" >
														<Grid.ColumnDefinitions >
															<ColumnDefinition Width="200" />
															<!-- HashTags -->
															<ColumnDefinition Width="*" />
															<!-- DateTime -->

															<ColumnDefinition Width="100" />
															<!-- Severity -->

															<ColumnDefinition Width="40" />
															<!-- RANK -->
															<ColumnDefinition Width="25" />
															<ColumnDefinition Width="25" />

															<ColumnDefinition Width="85" />
															<!-- TIME TAKEN -->
															<ColumnDefinition Width="65" />


															<ColumnDefinition Width="3*" />
															<!-- T odo -->
														</Grid.ColumnDefinitions >
														<TextBlock Grid.Column="0" Text="{Binding TagsSorted}" TextWrapping="WrapWithOverflow" VerticalAlignment="Top" KeyboardNavigation.IsTabStop="False" />
														<TextBlock Grid.Column="1" Text="{Binding StartDateTime}" Foreground="Red" Margin="4" Height="30" VerticalAlignment="Top" KeyboardNavigation.IsTabStop="False" />

														<ProgressBar Grid.Column="2" Minimum="0" Maximum="3" Value="{Binding Severity}" BorderBrush="DarkSlateGray" Background="Black" Foreground="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Value, Converter={StaticResource pbfg}}" Height="30" VerticalAlignment="Top" KeyboardNavigation.IsTabStop="False" />

														<Label Grid.Column="3" Content="{Binding Rank}" Margin="4" Height="30" VerticalAlignment="Top" KeyboardNavigation.IsTabStop="False" />
														<Button Grid.Column="4" FontFamily="Marlett" FontSize="20" Content="6" Click="RankAdjust_OnClick" CommandParameter="down" Height="30" VerticalAlignment="Top" KeyboardNavigation.IsTabStop="False" />
														<Button Grid.Column="5" FontFamily="Marlett" FontSize="20" Content="5" Click="RankAdjust_OnClick" CommandParameter="up" Height="30" VerticalAlignment="Top" KeyboardNavigation.IsTabStop="False" />

														<Label Grid.Column="6" MouseUp="TimeTakenTimer_OnClick" Content="{Binding TimeTakenInMinutes, UpdateSourceTrigger=PropertyChanged}" ContentStringFormat="{}{0:00.## :}" HorizontalContentAlignment="Right" Height="30" VerticalAlignment="Top" KeyboardNavigation.IsTabStop="False" >
															<Label.Style >
																<Style >
																	<Style.Triggers >
																		<DataTrigger Binding="{Binding IsTimerOn}" Value="True" >
																			<Setter Property="Label.Background" Value="Lime" />
																			<Setter Property="Label.Foreground" Value="Black" />
																		</DataTrigger >
																		<DataTrigger Binding="{Binding IsTimerOn}" Value="False" >
																			<Setter Property="Label.Background" Value="Transparent" />
																			<Setter Property="Label.Foreground" Value="LightGray" />
																		</DataTrigger >
																	</Style.Triggers >
																</Style >
															</Label.Style >
														</Label >
														<Label Grid.Column="7" MouseUp="TimeTakenTimer_OnClick" Content="{Binding TimeTaken.Second, UpdateSourceTrigger=PropertyChanged}" ContentStringFormat="{}{0:00.##}" HorizontalContentAlignment="Left" Height="30" VerticalAlignment="Top" KeyboardNavigation.IsTabStop="False" >
															<Label.Style >
																<Style >
																	<Style.Triggers >
																		<DataTrigger Binding="{Binding IsTimerOn}" Value="True" >
																			<Setter Property="Label.Background" Value="Lime" />
																			<Setter Property="Label.Foreground" Value="Black" />
																		</DataTrigger >
																		<DataTrigger Binding="{Binding IsTimerOn}" Value="False" >
																			<Setter Property="Label.Background" Value="Transparent" />
																			<Setter Property="Label.Foreground" Value="LightGray" />
																		</DataTrigger >
																	</Style.Triggers >
																</Style >
															</Label.Style >
														</Label >
														<TextBlock Grid.Column="8" Text="{Binding Todo}" TextAlignment="Left" TextWrapping="WrapWithOverflow" Margin="4,0" />
													</Grid >
												</DataTemplate >
											</ListBox.ItemTemplate >
										</ListBox >
									</Grid >
								</DataTemplate >
							</TabControl.ContentTemplate >
						</TabControl >
					</Grid>
					<Grid Grid.Row="0" Grid.Column="1" >
						<Grid.RowDefinitions>
							<RowDefinition Height="60" />
							<RowDefinition />
						</Grid.RowDefinitions>
						<Grid Grid.Row="0" >
							<TextBox x:Name="tbTodo" IsReadOnly="True" TextWrapping="WrapWithOverflow" />
						</Grid>
						<Grid Grid.Row="1" >
							<TextBox x:Name="tbNotes" ScrollViewer.VerticalScrollBarVisibility="Auto" AcceptsReturn="True" TextWrapping="WrapWithOverflow" LostFocus="Notes_OnSelectionChanged" />
						</Grid>
					</Grid>

					<!-- The add, radio buttons, and input field -->
					<Grid Grid.Row="1" >
						<Grid.ColumnDefinitions >
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="100" />
						</Grid.ColumnDefinitions >
						<TextBox x:Name="tbNewTodo" Grid.Column="0" ScrollViewer.VerticalScrollBarVisibility="Auto" TextWrapping="WrapWithOverflow" KeyboardNavigation.TabIndex="1" />
						<StackPanel Grid.Column="1" >
							<ComboBox Name="cbSeverity" SelectionChanged="SeverityComboBox_OnSelectionChange" Loaded="SeverityComboBox_OnIsLoaded" Unloaded="SeverityComboBox_OnIsLoaded" KeyboardNavigation.TabIndex="2" >
								<ComboBoxItem Content="None" />
								<ComboBoxItem Content="Low" IsSelected="True" />
								<ComboBoxItem Content="Med" />
								<ComboBoxItem Content="High" />
							</ComboBox >
							<Button Content="Add" Click="Add_OnClick" KeyboardNavigation.TabIndex="3" />
						</StackPanel >
					</Grid >
				</Grid >
			</TabItem >
			<TabItem Name="TabHistoryLog" Header="Log" >
				<Grid >
					<Grid.RowDefinitions >
						<RowDefinition Height="30" />
						<RowDefinition Height="*" />
					</Grid.RowDefinitions >
					<Button Grid.Row="0" Content="Refresh" Click="RefreshLog_OnClick" />
					<ListBox Name="lbHistoryLog" Grid.Row="1" ScrollViewer.VerticalScrollBarVisibility="Auto" />
				</Grid >
			</TabItem >
		</TabControl >
	</DockPanel >
</Window >

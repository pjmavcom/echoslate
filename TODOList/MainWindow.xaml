<Window x:Class="Echoslate.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:Echoslate.Converters" xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:local="clr-namespace:Echoslate" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:userControls="clr-namespace:Echoslate.UserControls" xmlns:viewModels="clr-namespace:Echoslate.ViewModels"
        xmlns:wpfTool="clr-namespace:Xceed.Wpf.Toolkit;assembly=Xceed.Wpf.Toolkit"
        x:Name="MainWindowInstance"
        Title="{Binding CurrentWindowTitle}"
        Width="1920" Height="1080"
        Style="{StaticResource {x:Type Window}}"
        mc:Ignorable="d">

    <Window.Resources>
        <RoutedUICommand x:Key="Add" Text="Text" />
        <RoutedUICommand x:Key="Complete" Text="Some Text" />
        <RoutedUICommand x:Key="Edit" Text="Another Text" />
        <RoutedUICommand x:Key="SwitchTab" Text="Yet Another Text" />
        <RoutedUICommand x:Key="SwitchSeverity" Text="And Yet Another Text" />
        <RoutedUICommand x:Key="QuickSave" Text="And Yet Another x2 Text" />
        <RoutedUICommand x:Key="QuickLoadPrevious" Text="And Yet Another Another Text" />
        <RoutedUICommand x:Key="StartStopTimer" Text="And Yet Another Another Text" />
        <converters:DebugConverter x:Key="DebugConverter" />

    </Window.Resources>

    <Window.InputBindings>
        <KeyBinding Key="Enter"
                    Command="{StaticResource Add}"
                    Modifiers="Alt" />
        <KeyBinding Key="Enter"
                    Command="{StaticResource Complete}"
                    Modifiers="Control" />
        <KeyBinding Key="Enter" Command="{StaticResource Edit}" />
        <KeyBinding Key="Divide"
                    Command="{StaticResource SwitchTab}"
                    CommandParameter="left" />
        <KeyBinding Key="Multiply"
                    Command="{StaticResource SwitchTab}"
                    CommandParameter="right" />
        <KeyBinding Key="Subtract"
                    Command="{StaticResource SwitchSeverity}"
                    CommandParameter="up" />
        <KeyBinding Key="Add"
                    Command="{StaticResource SwitchSeverity}"
                    CommandParameter="down" />
        <KeyBinding Key="S"
                    Command="{StaticResource QuickSave}"
                    Modifiers="Control" />
        <KeyBinding Key="OemComma"
                    Command="{StaticResource QuickLoadPrevious}"
                    Modifiers="Control" />
        <KeyBinding Key="P"
                    Command="{StaticResource StartStopTimer}"
                    Modifiers="Control" />
    </Window.InputBindings>


    <Grid HorizontalAlignment="Stretch"
          ClipToBounds="True" TextElement.FontFamily="Source Code Pro"
          TextElement.FontSize="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="40" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="500" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Menu Name="mnuMain"
                  Grid.Column="0"
                  FontSize="16">
                <MenuItem Header="_File">
                    <MenuItem Command="{Binding MenuNewCommand}" Header="New" />
                    <Separator />
                    <MenuItem Command="{Binding MenuLoadCommand}" Header="Load" />
                    <Separator />
                    <MenuItem Command="{Binding MenuSaveCommand}" Header="Save" />
                    <MenuItem Command="{Binding MenuSaveAsCommand}" Header="SaveAs" />
                    <Separator />
                    <MenuItem Command="{Binding MenuOptionsCommand}" Header="Options" />
                    <Separator />
                    <MenuItem Command="{Binding MenuQuitCommand}" Header="Quit" />
                </MenuItem>
                <MenuItem Header="Recent Loads"
                          ItemsSource="{Binding AppDataSettings.RecentFiles}"
                          Tag="{Binding}">
                    <MenuItem.ItemTemplate>
                        <DataTemplate>
                            <MenuItem Command="{Binding DataContext.MenuRecentFilesLoadCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                      CommandParameter="{Binding}"
                                      Header="{Binding}"
                                      Tag="{Binding}">
                                <MenuItem.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Command="{Binding Source={x:Reference MainWindowInstance}, Path=DataContext.MenuRecentFilesRemoveCommand}"
                                                  CommandParameter="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource AncestorType=ContextMenu}}"
                                                  Header="Remove" />
                                    </ContextMenu>
                                </MenuItem.ContextMenu>
                            </MenuItem>
                        </DataTemplate>
                    </MenuItem.ItemTemplate>
                </MenuItem>
                <MenuItem Command="{Binding MenuHelpCommand}" Header="Help" />
            </Menu>
            <StackPanel Grid.Column="1"
                        HorizontalAlignment="Right"
                        Orientation="Horizontal">
                <Grid>
                    <ProgressBar Name="pbPomo"
                                 Width="400" Height="30"
                                 Background="Maroon" BorderBrush="DarkSlateGray"
                                 Maximum="100" Minimum="0"
                                 Value="{Binding PomoTimeLeft, UpdateSourceTrigger=PropertyChanged}" />
                    <Label Name="lblPomo"
                           Width="400"
                           HorizontalContentAlignment="Right"
                           FontSize="20" FontWeight="SemiBold"
                           MouseDoubleClick="PomoTimerReset_OnClick" MouseUp="PomoTimerToggle_OnClick" />
                </Grid>
                <Label Width="100" Content="Work: " />
                <wpfTool:IntegerUpDown Name="iudPomoWork"
                                       Width="80"
                                       Minimum="1" ValueChanged="PomoWork_OnValueChanged"
                                       Value="{Binding PomoWorkTime, UpdateSourceTrigger=PropertyChanged}" />
                <Label Width="100" Content="Break: " />
                <wpfTool:IntegerUpDown Name="iudPomoBreak"
                                       Width="80"
                                       Minimum="1" ValueChanged="PomoBreak_OnValueChanged"
                                       Value="{Binding PomoBreakTime, UpdateSourceTrigger=PropertyChanged}" />
            </StackPanel>
        </Grid>
        <TabControl Name="tabControl"
                    Grid.Row="1"
                    HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                    ClipToBounds="True">

            <!--  VCS History tab  -->
            <TabItem Name="tabHistory"
                     Header="History" KeyboardNavigation.IsTabStop="False">
                <userControls:HistoryView DataContext="{Binding HistoryVM}" />
            </TabItem>

            <!--  VCS TodoList tab  -->
            <TabItem HorizontalAlignment="Stretch" VerticalAlignment="Center"
                     Header="Todo List">
                <userControls:TodoDisplayView DataContext="{Binding TodoListVM}" />
            </TabItem>

            <!--  VCS Kanban tab  -->
            <TabItem HorizontalAlignment="Stretch" VerticalAlignment="Center"
                     Header="Kanban">
                <userControls:TodoDisplayView DataContext="{Binding KanbanVM}" />
            </TabItem>

            <TabItem Header="Log">
                <!--  VCS Log tab  -->
                <StackPanel>
                    <Button Height="30" Content="Refresh" />
                    <!--  Click="RefreshLog_OnClick"  -->
                    <ListBox Name="lbHistoryLog" ScrollViewer.VerticalScrollBarVisibility="Auto" />
                </StackPanel>
            </TabItem>
        </TabControl>
        <!-- </DockPanel> -->
    </Grid>
</Window>